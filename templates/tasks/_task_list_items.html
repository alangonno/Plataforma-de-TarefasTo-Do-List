<ul class="task-list">
    {% for task in tasks %}
        <li class="task-item" id="task-item-{{ task.id }}">
            <div class="task-view" id="task-view-{{ task.id }}">
                <div class="task-main">
                    <div class="task-checkbox-wrapper">
                        <input 
                            type="checkbox" 
                            {% if task.completed %}checked{% endif %} 
                            data-task-id="{{ task.id }}" 
                            class="task-checkbox task-completed-toggle"
                            id="checkbox-{{ task.id }}"
                        >
                        <label for="checkbox-{{ task.id }}" class="checkbox-custom"></label>
                    </div>
                    
                    <div class="task-content">
                        <span class="task-title {% if task.completed %}task-completed{% endif %}">{{ task.title }}</span>
                        {% if task.due_date %}
                            <span class="task-due-date">Prazo: {{ task.due_date|date:"d/m/Y" }}</span>
                        {% endif %}
                        <p class="task-description">{{ task.description|default:"Sem descrição." }}</p>
                    </div>
                </div>
                
                <div class="task-actions">
                    <button data-task-id="{{ task.id }}" class="btn btn-edit edit-task-button">Editar</button>
                    <form action="{% url 'tasks:task_delete' task.id %}" method="post" class="delete-task-form" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" data-task-id="{{ task.id }}" class="btn btn-delete">Excluir</button>
                    </form>
                </div>
            </div>

            <div id="edit-form-{{ task.id }}" class="task-edit-form" style="display:none;">
                <form class="edit-task-form-actual" data-task-id="{{ task.id }}" action="{% url 'tasks:task_update' task.id %}" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="id_title_{{ task.id }}" class="form-label">Título</label>
                        <input type="text" id="id_title_{{ task.id }}" name="title" value="{{ task.title }}" required class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="id_description_{{ task.id }}" class="form-label">Descrição</label>
                        <textarea id="id_description_{{ task.id }}" name="description" class="form-textarea">{{ task.description|default:"" }}</textarea>
                    </div>
                    <div class="form-row form-row-split">
                        <div class="form-group">
                            <label for="id_due_date_{{ task.id }}" class="form-label">Data de Vencimento</label>
                            <input type="date" id="id_due_date_{{ task.id }}" name="due_date" value="{{ task.due_date|date:"Y-m-d"|default:"" }}" class="form-input">
                        </div>
                        <div class="form-group form-group-checkbox">
                            <div class="checkbox-wrapper">
                                <input type="checkbox" id="id_completed_{{ task.id }}" name="completed" {% if task.completed %}checked{% endif %} class="task-checkbox">
                                <label for="id_completed_{{ task.id }}" class="checkbox-label">Concluída</label>
                            </div>
                        </div>
                    </div>
                    <div class="edit-actions">
                        <button type="submit" class="btn btn-primary">Salvar</button>
                        <button type="button" class="btn btn-secondary cancel-edit-button" data-task-id="{{ task.id }}">Cancelar</button>
                    </div>
                </form>
            </div>
        </li>
    {% empty %}
        <li class="task-empty">
            <p class="empty-message">Nenhuma tarefa encontrada.</p>
        </li>
    {% endfor %}
</ul>
